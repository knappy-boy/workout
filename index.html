<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
  <meta name="theme-color" content="#FF2A2A" />
  <title>LIFTLOG ULTRA</title>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="style.css">
</head>
<body class="theme-light">
  <header>
    <div class="brand">
      <h1>LIFT<span class="outline">LOG</span></h1>
    </div>
    <div class="controls">
      <button id="btnTheme" class="icon-btn" aria-label="Toggle Theme">â—‘</button>
    </div>
  </header>

  <nav class="tabs-scroll">
    <div class="tabs">
      <button class="tab active" data-tab="dashboard">DASHBOARD</button>
      <button class="tab" data-tab="workout">WORKOUT</button>
      <button class="tab" data-tab="exercises">EXERCISES</button>
      <button class="tab" data-tab="history">HISTORY</button>
      <button class="tab" data-tab="stats">STATS</button>
    </div>
  </nav>

  <main>
    <section id="tab-dashboard" class="panel active">
      <div class="neo-card bg-white">
        <h2>START WORKOUT</h2>
        <select id="dashboardTemplateSelect" class="neo-select full mt-2">
          <option value="">Freestyle (no template)</option>
        </select>
        <button id="btnQuickStart" class="btn-red full mt-2 quick-start-btn">START</button>
      </div>

      <div class="neo-card bg-white mt-4">
        <h2>RECENT WORKOUTS</h2>
        <div id="recentLogs" class="recent-logs"></div>
      </div>

      <div class="neo-card bg-yellow mt-4">
        <div class="row">
          <button id="btnPrevMonth" class="btn-ghost">â—€</button>
          <h2 id="calendarMonth">JANUARY 2026</h2>
          <button id="btnNextMonth" class="btn-ghost">â–¶</button>
        </div>
        <div class="calendar-weekdays">
          <span>S</span><span>M</span><span>T</span><span>W</span><span>T</span><span>F</span><span>S</span>
        </div>
        <div id="calendarGrid" class="calendar-grid"></div>
      </div>

    </section>

    <section id="tab-workout" class="panel">
      <div id="activeWorkoutPanel" class="hidden">
        <!-- Minimal timer bar (shown when collapsed) -->
        <div id="timerBarMinimal" class="timer-bar-minimal mb-2">
          <button id="btnToggleTimerExpand" class="btn-ghost-mini">â–¼</button>
          <span id="workoutTimerMini" class="timer-mini">00:00</span>
          <button id="btnFinishWorkoutMini" class="btn-white-small">FINISH</button>
        </div>

        <!-- Full timer card (shown when expanded) -->
        <div id="timerCardFull" class="neo-card bg-red text-white mb-4 hidden">
          <div class="row">
            <button id="btnToggleTimerCollapse" class="btn-ghost text-white timer-toggle">â–²</button>
            <h2 id="workoutTimer" class="timer-large">00:00</h2>
            <button id="btnFinishWorkout" class="btn-white">FINISH</button>
          </div>
          <div class="muted-white text-center" id="workoutMeta"></div>
        </div>

        <div class="row mb-2">
           <button id="btnAddExToWorkout" class="btn-black full">+ EXERCISE</button>
           <button id="btnSaveTemplate" class="btn-black-outline icon-btn" title="Save as template">ðŸ’¾</button>
        </div>

        <div id="activeExerciseList" class="stack-list"></div>
      </div>

      <div id="startWorkoutPanel">
        <div class="neo-card bg-white">
          <h2>START WORKOUT</h2>
          <div class="row gap-2 mt-2">
            <select id="templateSelect" class="neo-select full">
              <option value="">(Select Template)</option>
            </select>
          </div>
          <div class="row gap-2 mt-2">
            <button id="btnStartEmpty" class="btn-black full">FREESTYLE</button>
            <button id="btnStartTemplate" class="btn-red full">START</button>
          </div>
        </div>

        <div class="neo-card bg-white mt-4">
          <div class="row collapsible-header" id="templatesHeader">
             <h3>MY TEMPLATES <span id="templatesToggle" class="toggle-icon">â–¼</span></h3>
             <button id="btnNewTemplate" class="btn-small">NEW</button>
          </div>
          <div id="templatesContent" class="collapsible-content">
            <ul id="templateList" class="simple-list mt-2"></ul>
          </div>
        </div>
      </div>
    </section>

    <section id="tab-exercises" class="panel">
      <div class="neo-card bg-white">
        <div class="row">
            <h2>LIBRARY</h2>
            <button id="btnShowAddEx" class="btn-black small">+ NEW</button>
        </div>
        
        <div id="libraryTabs" class="picker-tabs mt-2"></div>
        <input id="searchEx" class="neo-input full mt-2" placeholder="Search...">

        <div id="exerciseList" class="exercise-grid mt-2"></div>
      </div>

    </section>

    <section id="tab-history" class="panel">
      <div class="neo-card bg-white">
        <h2>LOGS</h2>
        <div id="historyLog" class="history-stream"></div>
      </div>
    </section>

    <section id="tab-stats" class="panel">
      <div class="neo-card bg-white">
        <h2>BODYWEIGHT</h2>
        <div class="chart-container">
          <canvas id="bwChart"></canvas>
        </div>
        <div class="row mt-2">
          <input id="bwInput" type="number" step="0.1" inputmode="decimal" placeholder="Current kg">
          <button id="btnLogBW" class="btn-black">LOG</button>
        </div>
        <div id="bwEntries" class="bw-entries mt-2"></div>
      </div>

      <div class="neo-card bg-white mt-4">
        <h2>EXERCISE PROGRESS</h2>
        <select id="statExSelect" class="neo-select full mb-2"></select>
        <div class="chart-container large">
          <canvas id="progChart"></canvas>
        </div>
        <div id="exerciseHistory" class="exercise-history mt-4"></div>
      </div>
       <div class="neo-card bg-black text-white mt-4">
        <h2>DATA</h2>
        <button id="btnExportCSV" class="btn-white full mt-2">EXPORT CSV</button>
        <button id="btnExportJSON" class="btn-white full mt-2">BACKUP (JSON)</button>
        <label class="btn-white full mt-2 text-center block">
           RESTORE (JSON) <input type="file" id="fileRestore" hidden>
        </label>
      </div>
    </section>

  </main>

  <div id="logModal" class="overlay hidden">
    <div class="drawer">
      <div class="drawer-handle"></div>
      <div class="drawer-header">
        <h2 id="logModalTitle">Bench Press</h2>
        <button id="logModalClose" class="btn-ghost">âœ•</button>
      </div>
      
      <div class="drawer-body">
        <div id="prevSessionInfo" class="info-box mb-2"></div>
        
        <div class="log-headers" id="logHeaders">
            <span>SET</span>
            <span class="h-val-1">KG</span>
            <span class="h-val-2">REPS</span>
            <span></span>
        </div>
        <div id="logRows" class="log-rows"></div>
        
        <div class="row mt-2 gap-2">
             <button id="btnAddRow" class="btn-black full">+ SET</button>
             <button id="btnSaveLog" class="btn-red full">SAVE</button>
        </div>
        <div class="row mt-2">
             <textarea id="logNotes" class="neo-input full" placeholder="Notes..."></textarea>
        </div>
      </div>
    </div>
  </div>

  <div id="pickerModal" class="overlay hidden">
     <div class="picker-box">
         <h3>SELECT EXERCISE</h3>
         <div id="pickerTabs" class="picker-tabs"></div>
         <input id="pickerSearch" class="neo-input full mb-2" placeholder="Search...">
         <div id="pickerList" class="picker-list"></div>
         <button id="pickerClose" class="btn-black full mt-2">CANCEL</button>
     </div>
  </div>

  <div id="addExModal" class="overlay hidden">
    <div class="modal-box">
      <h3 id="exModalTitle">NEW EXERCISE</h3>
      <label>Name <input id="newExName" class="neo-input"></label>
      <div class="row gap-2">
        <label>Type
            <select id="newExType" class="neo-select">
                <option value="strength">Strength</option>
                <option value="cardio">Cardio</option>
            </select>
        </label>
        <label id="muscleSelectWrapper">Muscle
            <select id="newExMuscle" class="neo-select"></select>
        </label>
      </div>
      <div id="strengthOptions">
        <div class="grid-2">
          <label>Equip <select id="newExEquip" class="neo-select"></select></label>
          <label>Increment <input id="newExInc" type="number" value="2.5" class="neo-input"></label>
        </div>
        <label class="checkbox-label mt-2">
          <input type="checkbox" id="newExAssisted">
          Assisted exercise (e.g. pull-up with band)
        </label>
        <p class="muted small">For assisted exercises, you'll log the assistance weight and we'll calculate effective weight</p>
      </div>
      <div id="cardioOptions" class="hidden mt-2">
         <label>Secondary metric name
           <input id="newExCardioMetric" class="neo-input" placeholder="e.g. floors, km, laps">
         </label>
         <p class="muted small">Leave blank for default (km)</p>
      </div>
      <div class="row mt-4">
        <button id="btnCloseExModal" class="btn-ghost">CANCEL</button>
        <button id="btnDeleteEx" class="btn-ghost text-red hidden">DELETE</button>
        <button id="btnSaveEx" class="btn-red">SAVE</button>
      </div>
    </div>
  </div>

  <div id="templateBuilderModal" class="overlay hidden">
    <div class="modal-box">
      <h3 id="templateBuilderTitle">CREATE TEMPLATE</h3>
      <label class="mt-2">Template Name
        <input id="templateBuilderName" class="neo-input" placeholder="e.g. Push Day">
      </label>
      <div class="mt-4">
        <div class="row">
          <strong>Exercises</strong>
          <button id="btnAddExToTemplate" class="btn-small">+ ADD</button>
        </div>
        <div id="templateBuilderList" class="template-builder-list mt-2"></div>
      </div>
      <div class="row mt-4">
        <button id="btnCloseTemplateBuilder" class="btn-ghost">CANCEL</button>
        <button id="btnSaveTemplateBuilder" class="btn-red">SAVE</button>
      </div>
    </div>
  </div>

  <div id="dayModal" class="overlay hidden">
    <div class="day-modal-box">
      <h3 id="dayModalTitle">January 29</h3>
      <div id="dayModalContent"></div>
      <button id="btnCloseDayModal" class="btn-black full mt-4">CLOSE</button>
    </div>
  </div>

  <script src="app.js"></script>
  <script>
    if ("serviceWorker" in navigator) navigator.serviceWorker.register("./sw.js");
  </script>
</body>
</html>
