:root {
  --red: #FF3333;
  --black: #1a1a1a;
  --white: #ffffff;
  --yellow: #FFEB3B;
  --gray: #f4f4f4;
  --border: 3px solid var(--black);
  --shadow: 5px 5px 0px 0px var(--black);
  --font: 'Courier New', Courier, monospace; /* Brutalist vibe */
  --radius: 0px; 
  --safe-area-bottom: env(safe-area-inset-bottom);
}

body.theme-dark {
  --red: #ff5555;
  --black: #ffffff; 
  --white: #121212; /* Bg */
  --yellow: #b5a300;
  --gray: #1e1e1e;
  --border: 3px solid var(--black);
  --shadow: 4px 4px 0px 0px #444;
}

/* BASE */
* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
body { margin: 0; background-color: var(--gray); color: var(--black); font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; padding-bottom: 80px; transition: background 0.3s; }

/* Hide scrollbars but keep scrolling */
* {
  -ms-overflow-style: none;
  scrollbar-width: none;
}
*::-webkit-scrollbar {
  display: none;
}

/* TYPOGRAPHY */
h1, h2, h3 { margin: 0; font-weight: 900; letter-spacing: -0.5px; text-transform: uppercase; }
h1 { font-size: 24px; font-style: italic; }
h1 .outline { color: transparent; -webkit-text-stroke: 1px var(--black); }
.muted-white { color: rgba(255,255,255,0.7); font-size: 0.9rem; }
.muted { color: rgba(0,0,0,0.5); }
.theme-dark .muted { color: rgba(255,255,255,0.5); }
.small { font-size: 0.85rem; }
.checkbox-label { display: flex; align-items: center; gap: 8px; cursor: pointer; }
.checkbox-label input[type="checkbox"] { width: 18px; height: 18px; }

/* LAYOUT */
header { display: flex; justify-content: space-between; padding: 15px; background: var(--white); border-bottom: var(--border); position: sticky; top: 0; z-index: 100; }
main { padding: 15px; max-width: 600px; margin: 0 auto; }
.row { display: flex; align-items: center; justify-content: space-between; }
.gap-2 { gap: 10px; } .mt-2 { margin-top: 10px; } .mt-4 { margin-top: 20px; } .mb-2 { margin-bottom: 10px; } .mb-4 { margin-bottom: 20px; }
.grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
.hidden { display: none !important; }

/* PANELS - Tab content visibility */
.panel { display: none; }
.panel.active { display: block; }

/* CARDS */
.neo-card {
  border: var(--border); box-shadow: var(--shadow); padding: 15px; margin-bottom: 20px;
  background: var(--white); transition: transform 0.1s;
}
.neo-card:active { transform: translate(2px, 2px); box-shadow: 2px 2px 0px 0px var(--black); }

.bg-red { background: var(--red); color: var(--white); }
.bg-black { background: var(--black); color: var(--white); }
.bg-yellow { background: var(--yellow); color: #000; }
.theme-dark .bg-yellow { background: #2a2a2a; color: #fff; border-color: #444; }
.bg-white { background: var(--white); }
.text-white { color: var(--white) !important; }

/* BUTTONS & INPUTS */
button, select, input, textarea { font-family: inherit; font-size: 1rem; outline: none; }

.btn-black, .btn-red, .btn-white, .btn-ghost {
  border: var(--border); padding: 12px 20px; font-weight: 800; cursor: pointer; text-transform: uppercase;
  display: inline-flex; justify-content: center; align-items: center;
}
.btn-black { background: #1a1a1a; color: #fff; }
.theme-dark .btn-black { background: #fff; color: #000; border-color: #fff; }
.btn-red { background: var(--red); color: white; }
.btn-white { background: var(--white); color: var(--black); }
.btn-ghost { background: transparent; border: 2px solid transparent; color: var(--black); }
.btn-small { padding: 5px 10px; font-size: 0.8rem; border-width: 2px; }
.icon-btn { border: none; background: none; font-size: 1.5rem; cursor: pointer; color: var(--black); }

.neo-input, .neo-select {
  width: 100%; padding: 10px; border: 2px solid var(--black); background: var(--white); 
  border-radius: 0; color: var(--black);
}
.full { width: 100%; }

/* TABS */
.tabs-scroll { overflow-x: auto; background: var(--white); border-bottom: var(--border); padding: 10px 0; }
.theme-dark .tabs-scroll { background: #121212; border-color: #333; }
.tabs { display: flex; padding: 0 15px; gap: 10px; min-width: max-content; }
.tab {
  border: 2px solid var(--black); background: transparent; padding: 8px 16px; 
  font-weight: 700; border-radius: 99px; cursor: pointer;
}
.tab { color: #1a1a1a; }
.tab.active { background: #1a1a1a; color: #fff; box-shadow: 3px 3px 0px 0px var(--red); }
.theme-dark .tab { color: #fff; border-color: #fff; background: transparent; }
.theme-dark .tab.active { background: #fff; color: #000; }

/* EXERCISE LIST */
.exercise-grid { display: grid; gap: 10px; }
.ex-item { display: flex; justify-content: space-between; align-items: center; padding: 10px; border: 2px solid var(--black); background: var(--gray); font-weight: bold; }
.ex-item-card { padding: 12px; border: 2px solid var(--black); background: var(--gray); }
.ex-item-header { display: flex; justify-content: space-between; align-items: center; font-weight: bold; }
.ex-name { flex: 1; }
.ex-history { margin-top: 6px; padding-top: 6px; border-top: 1px solid #ddd; }
.theme-dark .ex-history { border-color: #444; }
.theme-dark .ex-item-card { background: #1e1e1e; border-top-color: #444; border-right-color: #444; border-bottom-color: #444; }
.muscle-tag { font-size: 0.7rem; padding: 2px 6px; background: var(--black); color: var(--white); margin-left: 5px; text-transform: uppercase; }
/* Muscle group colors */
.ex-cat-Chest { border-left: 5px solid #E57373; }
.ex-cat-Back { border-left: 5px solid #64B5F6; }
.ex-cat-Shoulders { border-left: 5px solid #FFB74D; }
.ex-cat-Biceps { border-left: 5px solid #BA68C8; }
.ex-cat-Triceps { border-left: 5px solid #F06292; }
.ex-cat-Forearms { border-left: 5px solid #CE93D8; }
.ex-cat-Quads { border-left: 5px solid #81C784; }
.ex-cat-Hamstrings { border-left: 5px solid #4DB6AC; }
.ex-cat-Glutes { border-left: 5px solid #4DD0E1; }
.ex-cat-Calves { border-left: 5px solid #26A69A; }
.ex-cat-Core { border-left: 5px solid #90A4AE; }
.ex-cat-Cardio { border-left: 5px solid #FFD54F; }
.ex-cat-Other { border-left: 5px solid #78909C; }

/* HISTORY STREAM */
.history-month { margin-bottom: 15px; }
.history-month-header { display: flex; justify-content: space-between; align-items: center; padding: 10px 15px; background: #1a1a1a; color: #fff; font-weight: bold; cursor: pointer; }
.theme-dark .history-month-header { background: #333; }
.month-toggle { font-size: 0.8rem; }
.history-month-content { display: none; padding-top: 10px; }
.history-month-content.expanded { display: block; }
.history-entry { margin-bottom: 20px; border-left: 4px solid var(--black); padding-left: 15px; }
.history-date { font-weight: 900; }
.history-meta { font-size: 0.85rem; margin-bottom: 8px; color: #666; }
.theme-dark .history-meta { color: #aaa; }
.history-detail { font-size: 0.9rem; margin-top: 5px; }
.template-badge { display: inline-block; padding: 2px 8px; background: #E8A0A0; color: #000; font-size: 0.75rem; font-weight: bold; border-radius: 4px; }
.template-badge.freestyle { background: #ddd; }
.set-tag { display: inline-block; background: #ddd; padding: 2px 5px; margin: 2px; font-size: 0.8rem; border: 1px solid #000; }
.theme-dark .set-tag { background: #333; border-color: #fff; }

/* MODALS & DRAWERS */
.overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 200; display: flex; justify-content: center; }
dialog.neo-modal {
  border: var(--border);
  box-shadow: var(--shadow);
  background: var(--white);
  padding: 0;
  width: 90%;
  max-width: 400px;
  max-height: 80vh;
  color: var(--black);
}
dialog.neo-modal[open] {
  display: flex;
  flex-direction: column;
}
dialog.neo-modal::backdrop { background: rgba(0,0,0,0.8); }
.modal-content { padding: 20px; overflow-y: auto; flex: 1; max-height: calc(80vh - 40px); }

/* Day modal specific styling for iOS */
#dayModal {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  margin: 0;
  width: 90vw;
  max-width: 400px;
  max-height: 70vh;
  display: block;
}
#dayModal[open] {
  display: block;
}
#dayModal .modal-content {
  padding: 20px;
  max-height: calc(70vh - 20px);
  overflow-y: auto;
}

/* BOTTOM DRAWER FOR LOGGING */
.drawer { 
  position: absolute; bottom: 0; width: 100%; max-width: 600px; 
  background: var(--white); border-top: var(--border); 
  border-radius: 20px 20px 0 0; animation: slideUp 0.3s ease; 
  max-height: 90vh; display: flex; flex-direction: column;
}
.drawer-header { padding: 15px; border-bottom: 2px solid #eee; display: flex; justify-content: space-between; align-items: center; }
.drawer-body { padding: 15px; overflow-y: auto; padding-bottom: calc(20px + var(--safe-area-bottom)); }
.log-rows { display: flex; flex-direction: column; gap: 8px; }
.log-row { display: grid; grid-template-columns: 30px 1fr 1fr 40px; gap: 10px; align-items: center; }
.log-headers { display: grid; grid-template-columns: 30px 1fr 1fr 40px; gap: 10px; font-size: 0.8rem; font-weight: bold; text-align: center; margin-bottom: 5px; }

/* Ghost inputs for suggestions */
.ghost-val { color: rgba(0,0,0,0.4); }
.theme-dark .ghost-val { color: rgba(255,255,255,0.4); }

/* CALENDAR */
.calendar-weekdays { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; margin-bottom: 4px; text-align: center; font-weight: bold; font-size: 0.75rem; width: 100%; }
.calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; width: 100%; overflow: hidden; }
.cal-day { aspect-ratio: 1; border: 1px solid #1a1a1a; display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 0.8rem; background: #fff; color: #1a1a1a; cursor: pointer; padding: 2px; }
.cal-day.empty { background: transparent; border: none; cursor: default; }
.cal-day.has-workout { background: #1a1a1a; color: #fff; font-weight: bold; }
.cal-day.today { border: 3px solid var(--red) !important; }
.cal-day-num { line-height: 1; }
.cal-dots { display: flex; gap: 2px; margin-top: 2px; flex-wrap: wrap; justify-content: center; }
.cal-dot { width: 6px; height: 6px; border-radius: 50%; }
.theme-dark .cal-day { background: #2a2a2a; color: #fff; border-color: #444; }
.theme-dark .cal-day.has-workout { background: #fff !important; color: #1a1a1a !important; }
.day-exercise { margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid #eee; }
.day-exercise:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
.theme-dark .day-exercise { border-color: #333; }

/* EXERCISE HISTORY IN STATS */
.exercise-history { max-height: 300px; overflow-y: auto; }
.ex-history-item { padding: 8px 0; border-bottom: 1px solid #eee; }
.ex-history-item:last-child { border-bottom: none; }
.theme-dark .ex-history-item { border-color: #333; }

/* CHARTS */
.chart-container { position: relative; width: 100%; height: 200px; }
.chart-container.large { height: 250px; }
.chart-container canvas { width: 100% !important; height: 100% !important; }

/* ANIMATIONS */
@keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }

/* PICKER */
.picker-box { background: var(--white); width: 90%; max-width: 500px; max-height: 80vh; margin-top: 10vh; border: var(--border); box-shadow: var(--shadow); padding: 20px; display: flex; flex-direction: column; }
.picker-tabs { display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 10px; }
.picker-tab { padding: 5px 10px; border: 2px solid #ccc; background: transparent; font-size: 0.75rem; font-weight: 700; cursor: pointer; border-radius: 99px; }
.picker-tab.active { background: #1a1a1a; color: #fff; border-color: #1a1a1a; }
.theme-dark .picker-tab { border-color: #555; color: #fff; }
.theme-dark .picker-tab.active { background: #fff; color: #000; border-color: #fff; }
.picker-list { overflow-y: auto; flex: 1; display: flex; flex-direction: column; gap: 5px; }
.picker-item { padding: 12px; border: 2px solid #ccc; background: var(--gray); text-align: left; font-weight: bold; cursor: pointer; }
.picker-item:hover { border-color: var(--black); background: var(--white); }

/* QUICK START */
.quick-start-btn { padding: 20px; font-size: 1.2rem; }

/* RECENT LOGS */
.recent-logs { display: flex; flex-direction: column; gap: 10px; }
.recent-log-item { display: grid; grid-template-columns: 1fr auto; gap: 5px; padding: 10px; border: 2px solid var(--black); background: var(--gray); }
.recent-log-date { font-weight: 900; }
.recent-log-info { text-align: right; font-weight: 600; }
.recent-log-meta { grid-column: 1 / -1; }
.recent-log-muscles { grid-column: 1 / -1; font-size: 0.85rem; color: #666; }
.theme-dark .recent-log-muscles { color: #aaa; }
.theme-dark .recent-log-item { background: #1e1e1e; border-color: #444; }

/* BODYWEIGHT ENTRIES */
.bw-entries { max-height: 150px; overflow-y: auto; }
.bw-entry { display: flex; justify-content: space-between; align-items: center; padding: 8px; border-bottom: 1px solid #eee; font-size: 0.9rem; }
.theme-dark .bw-entry { border-color: #333; }
.bw-entry:last-child { border-bottom: none; }
.text-red { color: #FF3333 !important; }

/* SUGGESTIONS */
.suggestion { margin-top: 8px; padding: 8px; background: #e8f5e9; border-left: 3px solid #4caf50; font-size: 0.9rem; }
.theme-dark .suggestion { background: #1b3d1f; }

/* COLLAPSIBLE TIMER */
.timer-toggle { font-size: 1rem; padding: 5px 10px; }
.timer-collapsed { display: none; margin-top: 10px; text-align: center; }
.timer-expanded { display: block; }
.timer-toggle.expanded { transform: rotate(180deg); }

/* TEMPLATE BUILDER */
.template-builder-list { display: flex; flex-direction: column; gap: 8px; max-height: 250px; overflow-y: auto; }
.template-builder-item { display: flex; justify-content: space-between; align-items: center; padding: 10px; border: 2px solid var(--black); border-left: 5px solid #999; background: var(--gray); }
.theme-dark .template-builder-item { background: #1e1e1e; border-color: #444; }
.template-builder-empty { padding: 20px; text-align: center; color: #888; }

/* SIMPLE LIST (Templates) */
.simple-list { list-style: none; padding: 0; margin: 0; }
.simple-list li { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #ddd; }
.simple-list li:last-child { border-bottom: none; }
.theme-dark .simple-list li { border-color: #444; }
.simple-list li div { display: flex; gap: 5px; }

/* DRAG AND DROP */
.drag-handle { cursor: grab; padding: 0 10px 0 0; font-size: 1.2rem; color: #999; user-select: none; touch-action: none; }
.drag-handle:active { cursor: grabbing; }
.draggable-exercise { cursor: default; transition: transform 0.15s, box-shadow 0.15s; }
.draggable-exercise.dragging { opacity: 0.4; transform: scale(0.98); }
.draggable-exercise.drag-over { border-color: var(--red) !important; box-shadow: 0 0 0 3px var(--red); }
.touch-drag-clone { box-shadow: 0 10px 30px rgba(0,0,0,0.3); transform: rotate(2deg); }
.flex-1 { flex: 1; }
